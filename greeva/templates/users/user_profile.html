{% extends "vertical.html" %}
{% load static i18n crispy_forms_tags %}

{% block title %}My Profile{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/profile.css' %}">
{% endblock extra_css %}

{% block page_title %}
{% include 'partials/page-title.html' with title="My Profile" %}
{% endblock page_title %}

{% block page_content %}
<div class="row justify-content-center">
    <div class="col-xl-4 col-lg-5">
        <div class="card text-center">
            <div class="card-body">
                <div class="profile-image-container mb-3">
                    {% if current_user.profile_image %}
                    <img src="{{ current_user.profile_image }}" class="profile-image" alt="profile-image">
                    {% else %}
                    <img src="{% static '/images/users/avatar-1.jpg' %}" class="profile-image" alt="profile-image">
                    {% endif %}
                    <div class="profile-image-overlay">
                        <i class="ti ti-camera"></i>
                    </div>
                </div>

                <h4 class="mb-0">{{ current_user.Name|default:current_user.User_ID }}</h4>
                <p class="text-muted">{{ current_user.Email_ID }}</p>


                <div class="text-start mt-3">
                    <h4 class="font-13 text-uppercase">About Me :</h4>
                    <p class="text-muted font-13 mb-3">
                        {{ current_user.Role|default:"User" }}
                    </p>
                    <p class="text-muted mb-2 font-13"><strong>Full Name :</strong> <span class="ms-2">{{ current_user.Name|default:"-" }}</span></p>
                    <p class="text-muted mb-2 font-13"><strong>Mobile :</strong> <span class="ms-2">{{ current_user.Phone|default:"-" }}</span></p>
                    <p class="text-muted mb-2 font-13"><strong>Email :</strong> <span class="ms-2">{{ current_user.Email_ID }}</span></p>
                    <p class="text-muted mb-1 font-13"><strong>User ID :</strong> <span class="ms-2">{{ current_user.User_ID }}</span></p>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xl-8 col-lg-7">
        <div class="card">
            <div class="card-body">
                <h4 class="header-title mb-3">Update Profile</h4>
                {% if request.GET.updated %}
                <div class="alert alert-success">Profile updated successfully.</div>
                {% endif %}
                <form class="form-horizontal" method="post" action="{% url 'users:profile' %}">
                    {% csrf_token %}

                    <div class="mb-3">
                        <label for="id_name" class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="id_name" name="name"
                            value="{{ current_user.Name|default:'' }}" placeholder="Enter full name">
                    </div>

                    <div class="mb-3">
                        <label for="id_phone" class="form-label">Phone</label>
                        <input type="text" class="form-control" id="id_phone" name="phone"
                            value="{{ current_user.Phone|default:'' }}" placeholder="Enter phone number">
                    </div>

                    <div class="mb-3">
                        <label for="id_age" class="form-label">Age</label>
                        <input type="number" class="form-control" id="id_age" name="age"
                            value="{{ current_user.Age|default:'' }}" placeholder="Enter age">
                    </div>

                    <div class="mb-3">
                        <label for="id_profile_image" class="form-label">Profile Image URL (Cloudinary)</label>
                        <input type="url" class="form-control" id="id_profile_image" name="profile_image"
                            value="{{ current_user.profile_image|default:'' }}"
                            placeholder="Paste Cloudinary image URL">
                        <small class="text-muted">If you upload via Cloudinary, paste the secure URL here.</small>
                    </div>

                    <div class="mb-3 text-end">
                        <button class="btn btn-primary" type="submit">Update Info</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
